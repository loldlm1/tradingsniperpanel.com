<% content_for :title, t("dashboard.expert_advisors.guides_page_title", name: @expert_advisor.name, app: t("app.short_name")) %>
<% content_for :page_container_class, "w-full max-w-none px-0 py-0" %>
<% content_for :head do %>
  <%= stylesheet_link_tag "guides" %>
<% end %>

<% entry = @expert_advisor_entry %>
<% allowed_tier = Array(@expert_advisor.allowed_subscription_tiers).presence&.first || Billing::DashboardPlan::TIERS.first %>
<% cta_key = "#{allowed_tier}_monthly" %>
<% status = entry&.status || :locked %>
<% badge_class = case status
                when :active then "bg-emerald-100 text-emerald-700"
                when :trial then "bg-amber-100 text-amber-700"
                else "bg-slate-200 text-slate-700 dark:bg-slate-800 dark:text-slate-200"
                end %>

<div class="relative isolate">
  <div class="absolute inset-0 pointer-events-none -z-10 rounded-2xl overflow-hidden" aria-hidden="true">
    <div class="absolute top-0 left-1/2 -translate-x-1/2">
      <%= image_tag "docs/images/hero-illustration.svg", class: "max-w-none", width: 1972, height: 392, alt: "" %>
    </div>
  </div>

  <div class="w-full max-w-[96rem] mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-8 md:pt-12">
    <article>
      <div class="min-w-0">
          <header class="mb-6">
            <div class="flex items-start justify-between gap-4 flex-wrap">
              <div>
                <h1 class="h2 text-slate-800 mb-2 dark:text-slate-200"><%= @expert_advisor.name %></h1>
                <p class="text-lg text-slate-600 dark:text-slate-400"><%= @expert_advisor.description %></p>
              </div>
              <div class="flex items-center gap-2">
                <span class="px-2 py-1 rounded-full text-xs font-semibold <%= badge_class %>"><%= status.to_s.humanize %></span>
                <% unless entry&.accessible %>
                  <%= link_to t("dashboard.plans.cta.subscribe"), dashboard_plans_path(price_key: cta_key), class: "btn-sm inline-flex items-center text-slate-100 bg-blue-600 hover:bg-blue-700 shadow-xs" %>
                <% end %>
              </div>
            </div>
          </header>

          <% if @markdown_html.present? %>
            <div class="bg-white dark:bg-gray-800 shadow-sm rounded-xl border border-gray-200 dark:border-gray-700 p-5">
              <div
                class="ea-guide-content text-slate-600 dark:text-slate-400 space-y-6"
                data-scrollspy-container
                data-copy-label="<%= t("dashboard.expert_advisors.copy_code") %>"
                data-copied-label="<%= t("dashboard.expert_advisors.copied") %>"
              >
                <%= @markdown_html %>
              </div>
            </div>
          <% else %>
            <p class="text-slate-600 dark:text-slate-400"><%= t("dashboard.expert_advisors.guides_missing") %></p>
          <% end %>
      </div>
    </article>
  </div>
</div>
